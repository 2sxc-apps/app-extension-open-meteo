@inherits Custom.Hybrid.RazorTyped
@using System.Linq
@using AppCode.Extensions.OpenMeteo
@using AppCode.Extensions.OpenMeteo.Data

<h3>Weather Forecast</h3>
@{
  // Create a data source for hourly weather forecast from OpenMeteo API
  // Returns one record per hour for the specified number of forecast days
  var forecastDs = Kit.Data.GetSource<OpenMeteoForecast>(parameters: new {
    Latitude = 47.1674,       // Latitude of the location (Vaduz, Liechtenstein)
    Longitude = 9.4779,       // Longitude of the location
    Timezone = "auto",        // Use timezone of coordinates
    ForecastDays = 1          // Number of days to forecast (1 day = 24 hours)
  });

  // Convert the data source results to a strongly-typed list
  // Take only the first 24 hours (1 day) for display
  var items = AsList<OpenMeteoResult>(forecastDs).ToList();
}

@if (!items.Any())
{
  // Display message if the API didn't return any forecast data
  <p>No forecast data available</p>
}
else
{
  <p>Showing hourly forecast for the next @items.Count hours</p>
  
  <table class="table table-striped">
    <thead>
      <tr>
        <th>Time</th>
        <th>Temperature (°C)</th>
        <th>Weather</th>
      </tr>
    </thead>
    <tbody>
    @foreach (var item in items)
    {
      @* Each row displays one hour of forecast data *@
      <tr>
        <td>@item.When</td>
        <td>@item.Temperature °C</td>
        <td>@item.Weather</td>
      </tr>
    }
    </tbody>
  </table>
}