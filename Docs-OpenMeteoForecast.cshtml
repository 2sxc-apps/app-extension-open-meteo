@inherits Custom.Hybrid.RazorTyped
@using System.Linq
@using AppCode.Extensions.OpenMeteo
@using AppCode.Extensions.OpenMeteo.Data

@{
  // Create a data source for hourly weather forecast from OpenMeteo API
  // Returns one record per hour for the specified number of forecast days
  var forecastDs = Kit.Data.GetSource<OpenMeteoForecast>(parameters: new OpenMeteoParameters() {
    Latitude = 47.1674, // Vaduz, Liechtenstein
    Longitude = 9.4779, // Vaduz, Liechtenstein
    ForecastDays = 1    // Number of days to forecast
  });

  // Use the strongly-typed model
  var items = AsList<OpenMeteoResult>(forecastDs).ToList();
}

@* Display message if the API didn't return any forecast data, then exit *@
@if (!items.Any())
{
  <div class="alert alert-warning">
    No forecast data available
  </div>
  return;
}

@* Show the forecast data *@
<h3>
  Weather Forecast for the next @items.Count hours
</h3>

<table class="table table-striped">
  <thead>
    <tr>
      <th>When</th>
      <th>Temperature (°C)</th>
      <th>Weather</th>
    </tr>
  </thead>
  <tbody>
    @* Each row displays one hour of forecast data *@
    @foreach (var item in items)
    {
      <tr>
        <td>@item.When</td>
        <td>@item.Temperature °C</td>
        <td>@item.Weather</td>
      </tr>
    }
  </tbody>
</table>
